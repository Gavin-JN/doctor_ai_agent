# ç¡…è°·å°æ™º - åŸºäº LangChain4j çš„æ™ºèƒ½åŒ»ç–—åŠ©æ‰‹

## é¡¹ç›®ç®€ä»‹

ç¡…è°·å°æ™ºæ˜¯ä¸€ä¸ªåŸºäº Spring Boot å’Œ LangChain4j æ¡†æ¶å¼€å‘çš„æ™ºèƒ½åŒ»ç–—åŠ©æ‰‹ç³»ç»Ÿï¼Œæ¨¡æ‹ŸåŒ—äº¬åå’ŒåŒ»é™¢çš„æ™ºèƒ½å®¢æœã€‚è¯¥ç³»ç»Ÿé›†æˆäº†å¤§è¯­è¨€æ¨¡å‹ã€RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ã€å·¥å…·è°ƒç”¨å’ŒèŠå¤©è®°å¿†ç­‰åŠŸèƒ½ï¼Œä¸ºç”¨æˆ·æä¾›åŒ»ç–—å’¨è¯¢ã€æ™ºèƒ½åˆ†å¯¼è¯Šã€é¢„çº¦æŒ‚å·ç­‰æœåŠ¡ã€‚

## æ ¸å¿ƒåŠŸèƒ½

### ğŸ¤– æ™ºèƒ½å¯¹è¯

- åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„è‡ªç„¶è¯­è¨€å¯¹è¯
- æ”¯æŒå¤šè½®å¯¹è¯å’Œä¸Šä¸‹æ–‡è®°å¿†
- å‹å¥½çš„åŒ»ç–—é¡¾é—®è§’è‰²è®¾å®š

### ğŸ¥ åŒ»ç–—å’¨è¯¢

- æä¾›ä¸“ä¸šçš„åŒ»ç–—å»ºè®®å’Œå¥åº·å’¨è¯¢
- åŸºäºä¸´åºŠå®è·µå’Œç ”ç©¶çš„å‡†ç¡®åŒ»ç–—ä¿¡æ¯
- åŒ…å«ç—…å› åˆ†æã€è¯Šæ–­æµç¨‹ã€æ²»ç–—æ–¹æ¡ˆç­‰

### ğŸ¯ AI åˆ†å¯¼è¯Š

- æ ¹æ®æ‚£è€…ç—…æƒ…å’Œå°±åŒ»éœ€æ±‚æ™ºèƒ½æ¨èç§‘å®¤
- åŸºäºå‘é‡æ•°æ®åº“çš„æ™ºèƒ½åŒ¹é…

### ğŸ“… é¢„çº¦æŒ‚å·ç®¡ç†

- **æ™ºèƒ½æŸ¥è¯¢å·æº**ï¼šæ£€æŸ¥æŒ‡å®šç§‘å®¤ã€æ—¥æœŸã€æ—¶é—´çš„å¯é¢„çº¦æƒ…å†µ
- **æ™ºèƒ½é¢„çº¦æŒ‚å·**ï¼šæ”¯æŒå®Œæ•´çš„é¢„çº¦æµç¨‹
- **æ™ºèƒ½å–æ¶ˆæŒ‚å·**ï¼šä¾¿æ·çš„é¢„çº¦å–æ¶ˆæœåŠ¡
- **é¢„çº¦ä¿¡æ¯ç®¡ç†**ï¼šæ”¯æŒå§“åã€èº«ä»½è¯ã€ç§‘å®¤ã€æ—¥æœŸã€æ—¶é—´ã€åŒ»ç”Ÿç­‰å®Œæ•´ä¿¡æ¯

### ğŸ§  RAG çŸ¥è¯†æ£€ç´¢

- åŸºäºåå’ŒåŒ»é™¢çŸ¥è¯†åº“çš„æ™ºèƒ½æ£€ç´¢
- æ”¯æŒåŒ»ç”Ÿä¿¡æ¯æŸ¥è¯¢å’Œæ¨è
- å‘é‡åŒ–å­˜å‚¨å’Œè¯­ä¹‰æœç´¢

## æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

- **Java 17** - ç¼–ç¨‹è¯­è¨€
- **Spring Boot 3.5.3** - åº”ç”¨æ¡†æ¶
- **LangChain4j 1.0.0-beta3** - AI åº”ç”¨æ¡†æ¶
- **MyBatis Plus 3.5.7** - æ•°æ®è®¿é—®å±‚
- **MongoDB** - èŠå¤©è®°å¿†å­˜å‚¨
- **MySQL** - ä¸šåŠ¡æ•°æ®å­˜å‚¨
- **Knife4j 4.3.0** - API æ–‡æ¡£

### å¤§æ¨¡å‹æ”¯æŒ

- **DeepSeek** - ä¸»è¦ä½¿ç”¨çš„å¤§è¯­è¨€æ¨¡å‹
- **OpenAI** - å…¼å®¹ OpenAI æ ‡å‡†æ¥å£
- **Ollama** - æ”¯æŒæœ¬åœ°æ¨¡å‹éƒ¨ç½²

### é¡¹ç›®ç»“æ„

```
src/main/java/com/atguigu/java/ai/langchain4j/
â”œâ”€â”€ assistant/          # AIåŠ©æ‰‹ç›¸å…³
â”‚   â”œâ”€â”€ Assistant.java
â”‚   â”œâ”€â”€ MemoryChatAssistant.java
â”‚   â”œâ”€â”€ SeparateChatAssistant.java
â”‚   â””â”€â”€ XiaoZhiAgent.java
â”œâ”€â”€ bean/               # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ ChatForm.java
â”‚   â””â”€â”€ ChatMessages.java
â”œâ”€â”€ config/             # é…ç½®ç±»
â”‚   â”œâ”€â”€ MemoryChatAssistantConfig.java
â”‚   â”œâ”€â”€ SeparateChatAssistantConfig.java
â”‚   â””â”€â”€ XiaoZhiAgentConfig.java
â”œâ”€â”€ controller/         # æ§åˆ¶å™¨
â”‚   â””â”€â”€ XiaoZhiController.java
â”œâ”€â”€ entity/             # å®ä½“ç±»
â”‚   â””â”€â”€ Appointment.java
â”œâ”€â”€ mapper/             # æ•°æ®è®¿é—®å±‚
â”‚   â””â”€â”€ AppointmentMapper.java
â”œâ”€â”€ service/            # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ AppointmentService.java
â”‚   â””â”€â”€ impl/
â”‚       â””â”€â”€ AppointmentServiceImpl.java
â”œâ”€â”€ store/              # å­˜å‚¨ç›¸å…³
â”‚   â””â”€â”€ MongoChatMemoryStore.java
â”œâ”€â”€ tools/              # å·¥å…·ç±»
â”‚   â”œâ”€â”€ AppointmentTools.java
â”‚   â””â”€â”€ CalculatorTools.java
â””â”€â”€ XiaozhiApp.java     # å¯åŠ¨ç±»
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- JDK 17+
- Maven 3.6+
- MySQL 8.0+
- MongoDB 4.4+

### é…ç½®è¯´æ˜

1. **æ•°æ®åº“é…ç½®** (application.properties)

```properties
# MySQLé…ç½®
spring.datasource.url=jdbc:mysql://localhost:3306/guiguxiaozhi?useUnicode=true&&characterEncoding=UTF-8&&serverTimezone=Asia/Shanghai&&useSSL=false
spring.datasource.username=root
spring.datasource.password=123456

# MongoDBé…ç½®
spring.data.mongodb.uri=mongodb://localhost:27017/chat_memory_db
```

2. **å¤§æ¨¡å‹é…ç½®**

```properties
# DeepSeeké…ç½®
langchain4j.open-ai.chat-model.base-url=https://api.deepseek.com/v1
langchain4j.open-ai.chat-model.api-key=${DEEPSEEK_KEY}
langchain4j.open-ai.chat-model.model-name=deepseek-chat
```

### è¿è¡Œæ­¥éª¤

1. **å…‹éš†é¡¹ç›®**

```bash
git clone <repository-url>
cd java-ai-langchain4j
```

2. **é…ç½®ç¯å¢ƒå˜é‡**

```bash
# è®¾ç½®DeepSeek API Key
export DEEPSEEK_KEY=your_deepseek_api_key
```

3. **åˆ›å»ºæ•°æ®åº“**

```sql
CREATE DATABASE guiguxiaozhi;
```

4. **å¯åŠ¨åº”ç”¨**

```bash
mvn spring-boot:run
```
5. å‰ç«¯é¡¹ç›®å¯åŠ¨
```
npm run dev
```

6. **è®¿é—®åº”ç”¨**

- åº”ç”¨åœ°å€ï¼šhttp://localhost:8080
- API æ–‡æ¡£ï¼šhttp://localhost:8080/doc.html

## API æ¥å£

### å¯¹è¯æ¥å£

```http
POST /xiaozhi/chat
Content-Type: application/json

{
    "memoryId": 123,
    "message": "æˆ‘æƒ³é¢„çº¦å¿ƒå†…ç§‘çš„å·"
}
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "code": 200,
  "message": "æ‚¨å¥½ï¼æˆ‘æ˜¯ç¡…è°·å°æ™ºï¼ŒåŒ—äº¬åå’ŒåŒ»é™¢çš„æ™ºèƒ½å®¢æœåŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®æ‚¨é¢„çº¦å¿ƒå†…ç§‘çš„å·æºï¼Œè¯·æä¾›æ‚¨çš„å§“åã€èº«ä»½è¯å·ã€é¢„çº¦æ—¥æœŸå’Œæ—¶é—´ã€‚"
}
```

## æ ¸å¿ƒç‰¹æ€§

### 1. æ™ºèƒ½é¢„çº¦æµç¨‹

- è‡ªåŠ¨æŸ¥è¯¢å·æºå¯ç”¨æ€§
- æ™ºèƒ½æ¨èåˆé€‚åŒ»ç”Ÿ
- å®Œæ•´çš„é¢„çº¦ä¿¡æ¯éªŒè¯
- æ”¯æŒé¢„çº¦å–æ¶ˆå’Œä¿®æ”¹

### 2. å¤šæ¨¡æ€è®°å¿†ç®¡ç†

- åŸºäº MongoDB çš„æŒä¹…åŒ–èŠå¤©è®°å¿†
- æ”¯æŒå¤šç”¨æˆ·ä¼šè¯éš”ç¦»
- æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†

### 3. çŸ¥è¯†åº“é›†æˆ

- åå’ŒåŒ»é™¢ä¸“ä¸šçŸ¥è¯†åº“
- åŒ»ç”Ÿä¿¡æ¯æ•°æ®åº“
- å‘é‡åŒ–æ£€ç´¢å’ŒåŒ¹é…

### 4. å·¥å…·è°ƒç”¨èƒ½åŠ›

- é¢„çº¦ç®¡ç†å·¥å…·
- è®¡ç®—å™¨å·¥å…·
- å¯æ‰©å±•çš„å·¥å…·æ¡†æ¶

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„å·¥å…·

1. åœ¨`tools`åŒ…ä¸‹åˆ›å»ºå·¥å…·ç±»
2. ä½¿ç”¨`@Tool`æ³¨è§£æ ‡è®°æ–¹æ³•
3. åœ¨`XiaoZhiAgent`æ¥å£ä¸­æ³¨å†Œå·¥å…·

### æ‰©å±•çŸ¥è¯†åº“

1. å°†çŸ¥è¯†æ–‡æ¡£æ”¾å…¥`resources`ç›®å½•
2. åœ¨`XiaoZhiAgentConfig`ä¸­é…ç½®æ–‡æ¡£åŠ è½½
3. é‡æ–°æ„å»ºå‘é‡ç´¢å¼•

### è‡ªå®šä¹‰æç¤ºè¯

ä¿®æ”¹`resources/zhaozhi-prompt-template.txt`æ–‡ä»¶æ¥è‡ªå®šä¹‰ AI åŠ©æ‰‹çš„è§’è‰²å’Œè¡Œä¸ºã€‚

## æµ‹è¯•

è¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼š

```bash
mvn test
```

ä¸»è¦æµ‹è¯•ç±»ï¼š

- `SimpleTest` - åŸºç¡€åŠŸèƒ½æµ‹è¯•
- `OpenAiTest` - å¤§æ¨¡å‹æ¥å£æµ‹è¯•
- `ChatMemoryTest` - èŠå¤©è®°å¿†æµ‹è¯•
- `RAGTest` - çŸ¥è¯†æ£€ç´¢æµ‹è¯•

## éƒ¨ç½²

### Docker éƒ¨ç½²

```dockerfile
FROM openjdk:17-jdk-slim
COPY target/java-ai-langchain4j-1.0-SNAPSHOT.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "app.jar"]
```

### ç”Ÿäº§ç¯å¢ƒé…ç½®

- é…ç½®ç”Ÿäº§æ•°æ®åº“è¿æ¥
- è®¾ç½®åˆé€‚çš„ JVM å‚æ•°
- é…ç½®æ—¥å¿—çº§åˆ«
- è®¾ç½®å®‰å…¨è®¤è¯

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- é¡¹ç›® Issues
- é‚®ç®±ï¼š[2953301585@qq.com]

---

**æ³¨æ„**ï¼šæœ¬é¡¹ç›®ä»…ç”¨äºå­¦ä¹ å’Œæ¼”ç¤ºç›®çš„ï¼Œä¸åº”ç”¨äºç”Ÿäº§ç¯å¢ƒçš„åŒ»ç–—è¯Šæ–­ã€‚è¯·éµå¾ªç›¸å…³åŒ»ç–—æ³•è§„å’Œä¼¦ç†å‡†åˆ™ã€‚
